import{ShaderProgram as e,Plugin as t,PluginOrdinal as i,ShaderRenderer as r,ImageTexture as Z,ShaderPlugin as a,TextureReader as o}from'@geenee/armature';class n extends e{constructor(Xc,XG,W0=0x1){super(Xc,XG,['image'],{},g('max',W0),void 0x0,!0x0,!0x0);}}class s extends e{constructor(Xc,XG,W0=0x1){super(Xc,XG,['image'],{},g('min',W0),void 0x0,!0x0,!0x0);}}const g=(Xc,XG=0x1)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20sampler2D\x20image;\x0afloat\x20readImage(vec2\x20dxy)\x20{\x0a\x20\x20\x20\x20vec2\x20xy1\x20=\x20xy\x20+\x20dxy\x20/\x20wh;\x0a\x20\x20\x20\x20return\x20min(xy1.x,\x20xy1.y)\x20<\x200.0\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max(xy1.x,\x20xy1.y)\x20>=\x201.0\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x200.0\x20:\x20texture2D(image,\x20xy1).r;\x0a}\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20float\x20res\x20=\x20texture2D(image,\x20xy).r;\x0a\x20\x20\x20\x20for\x20(int\x20y\x20=\x20-'+XG+';\x20y\x20<=\x20'+XG+';\x20y++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20for\x20(int\x20x\x20=\x20-'+XG+';\x20x\x20<=\x20'+XG+';\x20x++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20res\x20=\x20'+Xc+'(res,\x20readImage(vec2(x,\x20y)));\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(res,\x20res,\x20res,\x201.0);\x0a}';var h=Object['defineProperty'],q0=Object['getOwnPropertySymbols'],q1=Object['prototype']['hasOwnProperty'],q2=Object['prototype']['propertyIsEnumerable'],q3=(Xc,XG,W0)=>XG in Xc?h(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,q4=(Xc,XG)=>{for(var W0 in XG||(XG={}))q1['call'](XG,W0)&&q3(Xc,W0,XG[W0]);if(q0){for(var W0 of q0(XG))q2['call'](XG,W0)&&q3(Xc,W0,XG[W0]);}return Xc;};class q5 extends t{constructor(Xc={'width':0x100,'height':0x100}){super(),this['size']=Xc,this['ordinal']=i['PreProcess'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['maskTexture']=new Z(XG,this['size'],!0x0,!0x0),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['maskTexture'])==null||Xc['dispose'](),delete this['maskTexture'],super['unload']());}async['update'](Xc,XG){const {maskTexture:W0}=this;if(!this['loaded']||!W0)return;const W1=q7(Xc);if(!W1||!W1['mask'])return;this['size']=q4({},W1['mask']['size']),W0['resize'](W1['mask']['size']),W0['update'](W1['mask']['buffer']);const W2=W0['texture']();W2&&(W1['maskTex']={'texture':W2,'size':W1['mask']['size'],'box':W1['mask']['box']});}}function q6(Xc){return[Xc[0x0][0x0],Xc[0x0][0x1],Xc[0x1][0x0]-Xc[0x0][0x0],Xc[0x1][0x1]-Xc[0x0][0x1]];}function q7(Xc){return'poses'in Xc&&Xc['poses'][0x0]||'faces'in Xc&&Xc['faces'][0x0]||'masks'in Xc&&Xc['masks'][0x0]||void 0x0;}function q8(Xc){var XG;return(XG=q7(Xc))==null?void 0x0:XG['mask'];}function q9(Xc){var XG;return(XG=q7(Xc))==null?void 0x0:XG['maskTex'];}var qq=Object['defineProperty'],qX=Object['getOwnPropertySymbols'],qW=Object['prototype']['hasOwnProperty'],qt=Object['prototype']['propertyIsEnumerable'],qF=(Xc,XG,W0)=>XG in Xc?qq(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,qy=(Xc,XG)=>{for(var W0 in XG||(XG={}))qW['call'](XG,W0)&&qF(Xc,W0,XG[W0]);if(qX){for(var W0 of qX(XG))qt['call'](XG,W0)&&qF(Xc,W0,XG[W0]);}return Xc;};class qi{constructor(){this['upscalers']=[],this['upscaleSize']={'width':0x400,'height':0x400};}['load'](Xc,XG,W0=0.55,W1=0x2){const W2=qy({},XG);for(let W3=0x0;W3<W1;W3++){W2['width']*=0x2,W2['height']*=0x2;const W4=new e(Xc,W2,['image','mask'],{'rect':'4f'},qQ(W0),void 0x0,!0x0,!0x0),W5=new e(Xc,W2,['mask'],{},qv(W0),void 0x0,!0x0,!0x0);this['upscalers']['push']({'edge':W4,'fill':W5});}this['upscaleSize']=W2;}['unload'](){this['upscalers']['forEach'](Xc=>{Xc['edge']['dispose'](),Xc['fill']['dispose']();}),this['upscalers']=[];}['upscale'](Xc,XG){const {upscalers:W0}=this;if(W0['length']<0x1)return!0x1;const W1=q6(Xc['box']);let W2=Xc['texture'];for(let W3=0x0;W3<W0['length'];W3++){const W4=W0[W3];W4['edge']['process']([XG,W2],{'rect':W1}),W4['fill']['process']([W4['edge']['output']()]),W2=W4['fill']['output']();}return!0x0;}['mask'](){var Xc;return((Xc=this['upscalers'][this['upscalers']['length']-0x1])==null?void 0x0:Xc['fill']['output']())||null;}['size'](){return this['upscaleSize'];}['resize'](Xc){const {upscalers:XG}=this,W0=qy({},Xc);for(let W1=0x0;W1<XG['length'];W1++)W0['width']*=0x2,W0['height']*=0x2,XG[W1]['edge']['resize'](W0),XG[W1]['fill']['resize'](W0);this['upscaleSize']=W0;}}const qQ=(Xc=0.55)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20vec4\x20rect;\x0auniform\x20sampler2D\x20image;\x0auniform\x20sampler2D\x20mask;\x0a\x0avec4\x20avgColor(vec2\x20xyMask,\x20vec2\x20whPix)\x20{\x0a\x20\x20\x20\x20vec2\x20xy\x20=\x20xyMask\x20*\x20rect.zw\x20+\x20rect.xy;\x0a\x20\x20\x20\x20vec2\x20dxy\x20=\x20whPix\x20*\x20rect.zw\x20/\x203.0;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x203;\x20i++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20for\x20(int\x20j\x20=\x200;\x20j\x20<\x203;\x20j++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color\x20+=\x20texture2D(image,\x20xy\x20+\x20vec2(i,\x20j)\x20*\x20dxy);\x0a\x20\x20\x20\x20return\x20color\x20/\x209.0;\x0a}\x0a\x0afloat\x20minDiff(vec2\x20xyI,\x20vec4\x20color)\x20{\x0a\x20\x20\x20\x20//\x20vec4\x20c\x20=\x20avgColor(xyI\x20/\x20wh,\x201.0\x20/\x20wh);\x0a\x20\x20\x20\x20//\x20vec3\x20diff\x20=\x20color.rgb\x20-\x20c.rgb;\x0a\x20\x20\x20\x20//\x20float\x20ra\x20=\x200.5\x20*\x20(color.r\x20+\x20c.r);\x0a\x20\x20\x20\x20//\x20diff\x20=\x20diff\x20*\x20diff;\x0a\x20\x20\x20\x20//\x20return\x20(2.0\x20+\x20ra)\x20*\x20diff.r\x20+\x204.0\x20*\x20diff.g\x20+\x20(3.0\x20-\x20ra)\x20*\x20diff.b;\x0a\x20\x20\x20\x20vec2\x20xyMask\x20=\x20xyI\x20/\x20wh;\x0a\x20\x20\x20\x20vec2\x20whPix\x20=\x201.0\x20/\x20(2.0\x20*\x20wh);\x0a\x20\x20\x20\x20float\x20dist\x20=\x20100.0;\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x202;\x20i++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20for\x20(int\x20j\x20=\x200;\x20j\x20<\x202;\x20j++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vec4\x20c\x20=\x20avgColor(xyMask\x20+\x20vec2(i,\x20j)\x20*\x20whPix,\x20whPix);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20diff\x20=\x20color.rgb\x20-\x20c.rgb;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20float\x20ra\x20=\x200.5\x20*\x20(color.r\x20+\x20c.r);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20diff\x20=\x20diff\x20*\x20diff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20dist\x20=\x20min((2.0\x20+\x20ra)\x20*\x20diff.r\x20+\x204.0\x20*\x20diff.g\x20+\x20(3.0\x20-\x20ra)\x20*\x20diff.b,\x20dist);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20return\x20dist;\x0a}\x0a\x0afloat\x20minDist(vec2\x20xyI,\x20vec2\x20dxy,\x20vec4\x20color)\x20{\x0a\x20\x20\x20\x20vec2\x20dxyI\x20=\x200.25\x20*\x20dxy;\x0a\x20\x20\x20\x20float\x20dist\x20=\x20100.0;\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x208;\x20i++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec4\x20c\x20=\x20texture2D(image,\x20(xyI\x20+\x20float(i)\x20*\x20dxyI)\x20/\x20wh\x20*\x20rect.zw\x20+\x20rect.xy);\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20diff\x20=\x20color.rgb\x20-\x20c.rgb;\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20ra\x20=\x200.5\x20*\x20(color.r\x20+\x20c.r);\x0a\x20\x20\x20\x20\x20\x20\x20\x20diff\x20=\x20diff\x20*\x20diff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20dist\x20=\x20min((2.0\x20+\x20ra)\x20*\x20diff.r\x20+\x204.0\x20*\x20diff.g\x20+\x20(3.0\x20-\x20ra)\x20*\x20diff.b,\x20dist);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20return\x20dist;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20xyI\x20=\x20floor(xy\x20*\x20wh);\x0a\x20\x20\x20\x20float\x20val[9];\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x203;\x20i++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20for\x20(int\x20j\x20=\x200;\x20j\x20<\x203;\x20j++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20val[j\x20*\x203\x20+\x20i]\x20=\x20texture2D(mask,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(xyI\x20+\x20vec2(i,\x20j)\x20-\x201.0)\x20/\x20wh).r;\x0a\x20\x20\x20\x20bool\x20fg[9];\x0a\x20\x20\x20\x20int\x20fgCount\x20=\x200;\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x209;\x20i++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20fg[i]\x20=\x20val[i]\x20>=\x20'+Xc+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20fgCount\x20+=\x20int(fg[i]);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(fgCount\x20<=\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20valMin\x20=\x20min(val[0],\x20min(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min(min(val[1],\x20val[2]),\x20min(val[3],\x20val[4])),\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min(min(val[5],\x20val[6]),\x20min(val[7],\x20val[8]))));\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(valMin,\x200,\x200,\x201);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(fgCount\x20>=\x209)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20valMax\x20=\x20max(val[0],\x20max(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max(max(val[1],\x20val[2]),\x20max(val[3],\x20val[4])),\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max(max(val[5],\x20val[6]),\x20max(val[7],\x20val[8]))));\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(valMax,\x200,\x200,\x201);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20vec2\x20dxy\x20=\x20normalize(vec2(\x0a\x20\x20\x20\x20\x20\x20\x20\x20val[2]\x20+\x202.0\x20*\x20val[5]\x20+\x20val[8]\x20-\x20val[0]\x20-\x202.0\x20*\x20val[3]\x20-\x20val[6],\x0a\x20\x20\x20\x20\x20\x20\x20\x20val[6]\x20+\x202.0\x20*\x20val[7]\x20+\x20val[8]\x20-\x20val[0]\x20-\x202.0\x20*\x20val[1]\x20-\x20val[2]));\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20avgColor(xyI\x20/\x20wh,\x201.0\x20/\x20wh);\x0a\x20\x20\x20\x20vec2\x20xyFg\x20=\x20xyI\x20+\x20(fg[4]\x20?\x202.0\x20:\x203.0)\x20*\x20dxy;\x0a\x20\x20\x20\x20vec2\x20xyBg\x20=\x20xyI\x20-\x20(fg[4]\x20?\x203.0\x20:\x202.0)\x20*\x20dxy;\x0a\x20\x20\x20\x20vec2\x20diffFgBg\x20=\x20sqrt(vec2(\x0a\x20\x20\x20\x20\x20\x20\x20\x20minDist(xyFg,\x20\x20dxy,\x20color),\x0a\x20\x20\x20\x20\x20\x20\x20\x20minDist(xyBg,\x20-dxy,\x20color)));\x0a\x20\x20\x20\x20diffFgBg\x20/=\x20diffFgBg.x\x20+\x20diffFgBg.y;\x0a\x20\x20\x20\x20vec2\x20valBgFg\x20=\x20vec2(texture2D(mask,\x20xyBg\x20/\x20wh).r,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20texture2D(mask,\x20xyFg\x20/\x20wh).r);\x0a\x20\x20\x20\x20float\x20valInter\x20=\x20dot(valBgFg,\x20diffFgBg);\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(valInter,\x201,\x200,\x201);\x0a}',qv=(Xc=0.55)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20sampler2D\x20mask;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20xyI\x20=\x20floor(xy\x20*\x20wh);\x0a\x20\x20\x20\x20vec4\x20val0\x20=\x20texture2D(mask,\x20xyI\x20/\x20wh);\x0a\x20\x20\x20\x20if\x20(val0.r\x20>=\x20'+Xc+')\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20val0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20float\x20val[9];\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x203;\x20i++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20for\x20(int\x20j\x20=\x200;\x20j\x20<\x203;\x20j++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20val[j\x20*\x203\x20+\x20i]\x20=\x20texture2D(mask,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(xyI\x20+\x20vec2(i,\x20j)\x20-\x201.0)\x20/\x20wh).r;\x0a\x20\x20\x20\x20bool\x20fg[9];\x0a\x20\x20\x20\x20int\x20fgCount\x20=\x200;\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x200;\x20i\x20<\x209;\x20i++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20fg[i]\x20=\x20val[i]\x20>=\x20'+Xc+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20fgCount\x20+=\x20int(fg[i]);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20float\x20valMax\x20=\x20max(val[0],\x20max(\x0a\x20\x20\x20\x20\x20\x20\x20\x20max(max(val[1],\x20val[2]),\x20max(val[3],\x20val[4])),\x0a\x20\x20\x20\x20\x20\x20\x20\x20max(max(val[5],\x20val[6]),\x20max(val[7],\x20val[8]))));\x0a\x20\x20\x20\x20if\x20(fg[0]\x20&&\x20fg[8]\x20||\x20fg[1]\x20&&\x20fg[7]\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20fg[2]\x20&&\x20fg[6]\x20||\x20fg[3]\x20&&\x20fg[5]\x20||\x20fgCount\x20>=\x204)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(valMax,\x201,\x200,\x201);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20val0;\x0a}';var qT=Object['defineProperty'],qJ=Object['getOwnPropertySymbols'],qz=Object['prototype']['hasOwnProperty'],qA=Object['prototype']['propertyIsEnumerable'],qd=(Xc,XG,W0)=>XG in Xc?qT(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,qk=(Xc,XG)=>{for(var W0 in XG||(XG={}))qz['call'](XG,W0)&&qd(Xc,W0,XG[W0]);if(qJ){for(var W0 of qJ(XG))qA['call'](XG,W0)&&qd(Xc,W0,XG[W0]);}return Xc;};class qr extends t{constructor(Xc=0.55,XG=0x2,W0={'width':0x100,'height':0x100}){super(),this['thresh']=Xc,this['steps']=XG,this['size']=W0,this['upscaler']=new qi(),this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['upscaler']['load'](XG,this['size'],this['thresh'],this['steps']),super['load'](Xc);}['unload'](){this['loaded']&&(this['upscaler']['unload'](),super['unload']());}async['update'](Xc,XG){var W0;const {renderer:W1}=this;if(!this['loaded']||!(W1 instanceof r))return;const W2=(W0=W1['input'])==null?void 0x0:W0['texture'](),W3=q7(Xc);if(!W3||!W3['maskTex']||!W2)return;this['size']=qk({},W3['maskTex']['size']),this['upscaler']['resize'](W3['maskTex']['size']);const W4=this['upscaler']['upscale'](W3['maskTex'],W2)&&this['upscaler']['mask']();W4&&(W3['maskTex']['texture']=W4,W3['maskTex']={'texture':W4,'size':qk({},this['upscaler']['size']()),'box':W3['maskTex']['box']});}}var qm=Object['defineProperty'],qZ=Object['getOwnPropertySymbols'],qj=Object['prototype']['hasOwnProperty'],qx=Object['prototype']['propertyIsEnumerable'],qR=(Xc,XG,W0)=>XG in Xc?qm(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,qf=(Xc,XG)=>{for(var W0 in XG||(XG={}))qj['call'](XG,W0)&&qR(Xc,W0,XG[W0]);if(qZ){for(var W0 of qZ(XG))qx['call'](XG,W0)&&qR(Xc,W0,XG[W0]);}return Xc;};class qU extends t{constructor(Xc=0x2,XG={'width':0x100,'height':0x100},W0=Math['floor'](0x2*Xc)){super(),this['smooth']=Xc,this['size']=XG,this['radius']=W0,this['gaussian']=[],this['ordinal']=i['Process'];const W1=-0.5/Xc**0x2;this['gaussian']['push'](0x1);let W2=0x1;for(let W3=0x1;W3<=W0;W3++){const W4=Math['exp'](W1*W3**0x2);this['gaussian']['push'](W4),this['gaussian']['unshift'](W4),W2+=0x2*W4;}for(let W5=0x0;W5<this['gaussian']['length'];W5++)this['gaussian'][W5]/=W2;}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['xpass']=new e(XG,this['size'],['image'],{'kernel':'1fv'},qa('x',this['radius']),void 0x0,!0x0,!0x0),this['xpass']['setUniform']('kernel',this['gaussian']),this['ypass']=new e(XG,this['size'],['image'],{'kernel':'1fv'},qa('y',this['radius']),void 0x0,!0x0,!0x0),this['ypass']['setUniform']('kernel',this['gaussian']),super['load'](Xc);}['unload'](){var Xc,XG;this['loaded']&&((Xc=this['xpass'])==null||Xc['dispose'](),delete this['xpass'],(XG=this['ypass'])==null||XG['dispose'](),delete this['ypass'],super['unload']());}async['update'](Xc,XG){const W0=q9(Xc);if(!W0)return;const {xpass:W1,ypass:W2}=this;if(!W1||!W2)return;this['size']=qf({},W0['size']),W1['resize'](W0['size']),W2['resize'](W0['size']);const W3=W1['process']([W0['texture']]),W4=W3&&W2['process']([W3]);W4&&(W0['texture']=W4);}}const qa=(Xc,XG)=>{const W0=Xc==='x'?['x','x','0']:['y','0','y'];return'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20float\x20kernel['+(0x2*XG+0x1)+'];\x0auniform\x20sampler2D\x20image;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20float\x20result\x20=\x200.0;\x0a\x20\x20\x20\x20for\x20(int\x20'+W0[0x0]+'\x20=\x20'+-XG+';\x20'+W0[0x0]+'\x20<=\x20'+XG+';\x20'+W0[0x0]+'++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20result\x20+=\x20kernel['+W0[0x0]+'\x20+\x20'+XG+']\x20*\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20texture2D(image,\x20xy\x20+\x20vec2('+W0[0x1]+',\x20'+W0[0x2]+')\x20/\x20wh).r;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(result,\x20result,\x20result,\x201.0);\x0a}';};var qD=Object['defineProperty'],qE=Object['getOwnPropertySymbols'],qL=Object['prototype']['hasOwnProperty'],qw=Object['prototype']['propertyIsEnumerable'],qS=(Xc,XG,W0)=>XG in Xc?qD(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,qo=(Xc,XG)=>{for(var W0 in XG||(XG={}))qL['call'](XG,W0)&&qS(Xc,W0,XG[W0]);if(qE){for(var W0 of qE(XG))qw['call'](XG,W0)&&qS(Xc,W0,XG[W0]);}return Xc;};class qn extends t{constructor(Xc=0.9,XG={'width':0x100,'height':0x100}){super(),this['alpha']=Xc,this['size']=XG,this['filterTurn']=!0x1,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['filters']=[0x0,0x1]['map'](()=>new e(XG,this['size'],['image','smooth'],{},qO(this['alpha']),void 0x0,!0x0,!0x0)),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['filters'])==null||Xc['forEach'](XG=>XG['dispose']()),delete this['filters'],super['unload']());}async['update'](Xc,XG){const W0=q9(Xc);if(!W0)return;const {filters:W1}=this;if(!W1)return;this['size']=qo({},W0['size']),this['filterTurn']=!this['filterTurn'];let [W2,W3]=W1;[W2,W3]=this['filterTurn']?[W3,W2]:[W2,W3],W3['resize'](W0['size']);const W4=W3['process']([W0['texture'],W2['output']()]);W4&&(W0['texture']=W4);}}const qO=(Xc=0.9)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20sampler2D\x20image;\x0auniform\x20sampler2D\x20smooth;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20float\x20mask\x20=\x20texture2D(image,\x20xy).r;\x0a\x20\x20\x20\x20float\x20t\x20=\x20mask\x20-\x200.5;\x0a\x20\x20\x20\x20float\x20x\x20=\x20t\x20*\x20t;\x0a\x20\x20\x20\x20float\x20alpha\x20=\x201.0\x20-\x20min(\x0a\x20\x20\x20\x20\x20\x20\x20\x20x\x20*\x20(5.74062006\x20+\x20x\x20*\x20(-2.90180189\x20+\x20x\x20*\x20(-30.34594285\x20+\x0a\x20\x20\x20\x20\x20\x20\x20\x20x\x20*\x20(153.83657925\x20+\x20x\x20*\x20(-387.53530186))))),\x201.0);\x0a\x20\x20\x20\x20float\x20prev\x20=\x20texture2D(smooth,\x20xy).r;\x0a\x20\x20\x20\x20float\x20smoothed\x20=\x20mask\x20+\x20(prev\x20-\x20mask)\x20*\x20(alpha\x20*\x20'+Xc['toFixed'](0x3)+');\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(smoothed);\x0a}';var ql=Object['defineProperty'],qu=Object['getOwnPropertySymbols'],qH=Object['prototype']['hasOwnProperty'],qK=Object['prototype']['propertyIsEnumerable'],qp=(Xc,XG,W0)=>XG in Xc?ql(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,qY=(Xc,XG)=>{for(var W0 in XG||(XG={}))qH['call'](XG,W0)&&qp(Xc,W0,XG[W0]);if(qu){for(var W0 of qu(XG))qK['call'](XG,W0)&&qp(Xc,W0,XG[W0]);}return Xc;};class qB extends t{constructor(Xc=0x8,XG={'width':0x100,'height':0x100}){super(),this['radius']=Xc,this['size']=XG,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['ypass']=new e(XG,this['size'],['mask','image'],{'rect':'4f'},qs(this['radius']),void 0x0,!0x1,!0x0),this['xpass']=new e(XG,this['size'],['mask','image'],{'rect':'4f'},qP(this['radius']),void 0x0,!0x0,!0x0),super['load'](Xc);}['unload'](){var Xc,XG;this['loaded']&&((Xc=this['ypass'])==null||Xc['dispose'](),delete this['ypass'],(XG=this['xpass'])==null||XG['dispose'](),delete this['xpass'],super['unload']());}async['update'](Xc,XG){const {renderer:W0,ypass:W1,xpass:W2}=this;if(!this['loaded']||!W1||!W2||!(W0 instanceof r))return;const W3=q9(Xc);if(!W3)return;this['size']=qY({},W3['size']),W1['resize'](W3['size']);const W4=W1['process']([W3['texture'],W0['current']],{'rect':q6(W3['box'])});W2['resize'](W3['size']);const W5=W2['process']([W4,W0['current']],{'rect':q6(W3['box'])});W3['texture']=W5||W3['texture'];}}const qs=(Xc=0x8)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20vec4\x20rect;\x0auniform\x20sampler2D\x20mask;\x0auniform\x20sampler2D\x20image;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20whPix\x20=\x201.0\x20/\x20wh;\x0a\x20\x20\x20\x20vec4\x20stats\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20for\x20(int\x20y\x20=\x20-'+Xc+';\x20y\x20<=\x20'+Xc+';\x20y++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2\x20xyMask\x20=\x20xy\x20+\x20vec2(0,\x20y)\x20*\x20whPix;\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2\x20xyImg\x20=\x20xyMask\x20*\x20rect.zw\x20+\x20rect.xy;\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20rgb\x20=\x20texture2D(image,\x20xyImg).rgb;\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20i\x20=\x20dot(rgb,\x20vec3(0.299,\x200.587,\x200.114));\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20m\x20=\x20texture2D(mask,\x20xyMask).r;\x0a\x20\x20\x20\x20\x20\x20\x20\x20stats\x20+=\x20vec4(i,\x20m,\x20i\x20*\x20i,\x20i\x20*\x20m);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20stats\x20/=\x20'+(0x2*Xc+0x1)['toFixed'](0x1)+';\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20stats;\x0a}',qP=(Xc=0x8)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20vec4\x20rect;\x0auniform\x20sampler2D\x20mask;\x0auniform\x20sampler2D\x20image;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20whPix\x20=\x201.0\x20/\x20wh;\x0a\x20\x20\x20\x20vec4\x20stats\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20for\x20(int\x20x\x20=\x20-'+Xc+';\x20x\x20<=\x20'+Xc+';\x20x++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2\x20xyMask\x20=\x20xy\x20+\x20vec2(x,\x200)\x20*\x20whPix;\x0a\x20\x20\x20\x20\x20\x20\x20\x20stats\x20+=\x20texture2D(mask,\x20xyMask);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20stats\x20/=\x20'+(0x2*Xc+0x1)['toFixed'](0x1)+';\x0a\x20\x20\x20\x20vec2\x20xyImg\x20=\x20xy\x20*\x20rect.zw\x20+\x20rect.xy;\x0a\x20\x20\x20\x20vec3\x20rgb\x20=\x20texture2D(image,\x20xyImg).rgb;\x0a\x20\x20\x20\x20float\x20i\x20=\x20dot(rgb,\x20vec3(0.299,\x200.587,\x200.114));\x0a\x20\x20\x20\x20float\x20varII\x20=\x20stats.z\x20-\x20stats.x\x20*\x20stats.x;\x0a\x20\x20\x20\x20float\x20varIM\x20=\x20stats.w\x20-\x20stats.x\x20*\x20stats.y;\x0a\x20\x20\x20\x20float\x20a\x20=\x20varIM\x20/\x20(varII\x20+\x200.001);\x0a\x20\x20\x20\x20float\x20b\x20=\x20stats.y\x20-\x20a\x20*\x20stats.x;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(a\x20*\x20i\x20+\x20b);\x0a}';var qg=Object['defineProperty'],qN=Object['getOwnPropertySymbols'],qI=Object['prototype']['hasOwnProperty'],qC=Object['prototype']['propertyIsEnumerable'],qb=(Xc,XG,W0)=>XG in Xc?qg(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,qV=(Xc,XG)=>{for(var W0 in XG||(XG={}))qI['call'](XG,W0)&&qb(Xc,W0,XG[W0]);if(qN){for(var W0 of qN(XG))qC['call'](XG,W0)&&qb(Xc,W0,XG[W0]);}return Xc;};class qM extends t{constructor(Xc=0x1,XG={'width':0x100,'height':0x100}){super(),this['radius']=Xc,this['size']=XG,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['shader']=new n(XG,this['size'],this['radius']),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['shader'])==null||Xc['dispose'](),delete this['shader'],super['unload']());}async['update'](Xc,XG){const {shader:W0}=this;if(!this['loaded']||!W0)return;const W1=q9(Xc);if(!W1)return;this['size']=qV({},W1['size']),W0['resize'](W1['size']);const W2=W0['process']([W1['texture']]);W2&&(W1['texture']=W2);}}var qh=Object['defineProperty'],qc=Object['getOwnPropertySymbols'],qG=Object['prototype']['hasOwnProperty'],X0=Object['prototype']['propertyIsEnumerable'],X1=(Xc,XG,W0)=>XG in Xc?qh(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,X2=(Xc,XG)=>{for(var W0 in XG||(XG={}))qG['call'](XG,W0)&&X1(Xc,W0,XG[W0]);if(qc){for(var W0 of qc(XG))X0['call'](XG,W0)&&X1(Xc,W0,XG[W0]);}return Xc;};class X3 extends t{constructor(Xc=0x1,XG={'width':0x100,'height':0x100}){super(),this['radius']=Xc,this['size']=XG,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['shader']=new s(XG,this['size'],this['radius']),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['shader'])==null||Xc['dispose'](),delete this['shader'],super['unload']());}async['update'](Xc,XG){const {shader:W0}=this;if(!this['loaded']||!W0)return;const W1=q9(Xc);if(!W1)return;this['size']=X2({},W1['size']),W0['resize'](W1['size']);const W2=W0['process']([W1['texture']]);W2&&(W1['texture']=W2);}}var X4=Object['defineProperty'],X5=Object['getOwnPropertySymbols'],X6=Object['prototype']['hasOwnProperty'],X7=Object['prototype']['propertyIsEnumerable'],X8=(Xc,XG,W0)=>XG in Xc?X4(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,X9=(Xc,XG)=>{for(var W0 in XG||(XG={}))X6['call'](XG,W0)&&X8(Xc,W0,XG[W0]);if(X5){for(var W0 of X5(XG))X7['call'](XG,W0)&&X8(Xc,W0,XG[W0]);}return Xc;};class Xq extends t{constructor(Xc=0x1,XG={'width':0x100,'height':0x100}){super(),this['radius']=Xc,this['size']=XG,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['shader']=this['radius']>0x0?new n(XG,this['size'],this['radius']):new s(XG,this['size'],-this['radius']),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['shader'])==null||Xc['dispose'](),delete this['shader'],super['unload']());}async['update'](Xc,XG){const {shader:W0}=this;if(!this['loaded']||!W0)return;const W1=q9(Xc);if(!W1)return;this['size']=X9({},W1['size']),W0['resize'](W1['size']);const W2=W0['process']([W1['texture']]);W2&&(W1['texture']=W2);}}var XX=Object['defineProperty'],XW=Object['getOwnPropertySymbols'],Xt=Object['prototype']['hasOwnProperty'],XF=Object['prototype']['propertyIsEnumerable'],Xy=(Xc,XG,W0)=>XG in Xc?XX(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,Xi=(Xc,XG)=>{for(var W0 in XG||(XG={}))Xt['call'](XG,W0)&&Xy(Xc,W0,XG[W0]);if(XW){for(var W0 of XW(XG))XF['call'](XG,W0)&&Xy(Xc,W0,XG[W0]);}return Xc;};class XQ extends t{constructor(Xc=0.55,XG={'width':0x100,'height':0x100}){super(),this['thresh']=Xc,this['size']=XG,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['shader']=new e(XG,this['size'],['image'],{},Xv(this['thresh']),void 0x0,!0x0,!0x0),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['shader'])==null||Xc['dispose'](),delete this['shader'],super['unload']());}async['update'](Xc,XG){const {renderer:W0,shader:W1}=this;if(!this['loaded']||!W1||!(W0 instanceof r))return;const W2=q9(Xc);if(!W2)return;this['size']=Xi({},W2['size']),W1['resize'](W2['size']);const W3=W1['process']([W2['texture']]);W2['texture']=W3||W2['texture'];}}const Xv=(Xc=0.55)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20sampler2D\x20image;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20float\x20v\x20=\x20texture2D(image,\x20xy).r\x20<\x20'+Xc+'\x20?\x200.0\x20:\x201.0;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(v,\x20v,\x20v,\x201.0);\x0a}';var XT=Object['defineProperty'],XJ=Object['getOwnPropertySymbols'],Xz=Object['prototype']['hasOwnProperty'],XA=Object['prototype']['propertyIsEnumerable'],Xd=(Xc,XG,W0)=>XG in Xc?XT(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,Xk=(Xc,XG)=>{for(var W0 in XG||(XG={}))Xz['call'](XG,W0)&&Xd(Xc,W0,XG[W0]);if(XJ){for(var W0 of XJ(XG))XA['call'](XG,W0)&&Xd(Xc,W0,XG[W0]);}return Xc;};class Xr extends t{constructor(Xc=0.25,XG=0.75,W0={'width':0x100,'height':0x100}){super(),this['edge0']=Xc,this['edge1']=XG,this['size']=W0,this['ordinal']=i['Process'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['shader']=new e(XG,this['size'],['image'],{},Xm(this['edge0'],this['edge1']),void 0x0,!0x0,!0x0),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['shader'])==null||Xc['dispose'](),delete this['shader'],super['unload']());}async['update'](Xc,XG){const {renderer:W0,shader:W1}=this;if(!this['loaded']||!W1||!(W0 instanceof r))return;const W2=q9(Xc);if(!W2)return;this['size']=Xk({},W2['size']),W1['resize'](W2['size']);const W3=W1['process']([W2['texture']]);W2['texture']=W3||W2['texture'];}}const Xm=(Xc=0.25,XG=0.75)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20sampler2D\x20image;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20float\x20v\x20=\x20texture2D(image,\x20xy).r;\x0a\x20\x20\x20\x20v\x20=\x20smoothstep('+Xc['toFixed'](0x3)+',\x20'+XG['toFixed'](0x3)+',\x20v);\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(v,\x20v,\x20v,\x201.0);\x0a}';class XZ extends a{constructor(Xc=0xb,XG=0.55,W0=Math['floor'](0x2*Xc)){super(['image','smooth','mask'],{'rect':'4f','kernel':'1fv'},Xx(W0,XG)),this['smooth']=Xc,this['radius']=W0,this['gaussian']=[];const W1=-0.5/Xc**0x2;this['gaussian']['push'](0x1);let W2=0x1;for(let W3=0x1;W3<=W0;W3++){const W4=Math['exp'](W1*W3**0x2);this['gaussian']['push'](W4),this['gaussian']['unshift'](W4),W2+=0x2*W4;}for(let W5=0x0;W5<this['gaussian']['length'];W5++)this['gaussian'][W5]/=W2;}async['load'](Xc){var XG;const W0=Xc instanceof r&&Xc['shaderCtx'];this['loaded']||!W0||(this['xpass']=new e(W0,this['size'],['image'],{'kernel':'1fv'},Xj(this['radius'])),await super['load'](Xc),this['xpass']['setUniform']('kernel',this['gaussian']),(XG=this['shader'])==null||XG['setUniform']('kernel',this['gaussian']));}['unload'](){var Xc;this['loaded']&&((Xc=this['xpass'])==null||Xc['dispose'](),delete this['xpass'],super['unload']());}async['process'](Xc,XG){const W0=q9(Xc);if(!W0)return!0x1;const {xpass:W1,shader:W2}=this;if(!W1||!W2)return!0x1;const W3=q6(W0['box']);return W1['process']([XG]),W2['process']([XG,W1['output'](),W0['texture']],{'rect':W3}),!0x0;}['setupVideo'](Xc){var XG;super['setupVideo'](Xc),(XG=this['xpass'])==null||XG['resize'](Xc);}}const Xj=Xc=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20float\x20kernel['+(0x2*Xc+0x1)+'];\x0auniform\x20sampler2D\x20image;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20result\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20for\x20(int\x20x\x20=\x20'+-Xc+';\x20x\x20<=\x20'+Xc+';\x20x++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20result\x20+=\x20kernel[x\x20+\x20'+Xc+']\x20*\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20texture2D(image,\x20xy\x20+\x20vec2(x,\x200)\x20/\x20wh).rgb;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(result,\x201.0);\x0a}',Xx=(Xc,XG=0.55)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20vec4\x20rect;\x0auniform\x20float\x20kernel['+(0x2*Xc+0x1)+'];\x0auniform\x20sampler2D\x20image;\x0auniform\x20sampler2D\x20smooth;\x0auniform\x20sampler2D\x20mask;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20xyMask\x20=\x20(xy\x20-\x20rect.xy)\x20/\x20rect.zw;\x0a\x20\x20\x20\x20bool\x20fg\x20=\x20min(xyMask.x,\x20xyMask.y)\x20>=\x200.0\x20&&\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max(xyMask.x,\x20xyMask.y)\x20<=\x201.0\x20&&\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20texture2D(mask,\x20xyMask).r\x20>=\x20'+XG+';\x0a\x20\x20\x20\x20if\x20(fg)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20texture2D(image,\x20xy);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20vec3\x20result\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20for\x20(int\x20y\x20=\x20'+-Xc+';\x20y\x20<=\x20'+Xc+';\x20y++)\x0a\x20\x20\x20\x20\x20\x20\x20\x20result\x20+=\x20kernel[y\x20+\x20'+Xc+']\x20*\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20texture2D(smooth,\x20xy\x20+\x20vec2(0,\x20y)\x20/\x20wh).rgb;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(result,\x201.0);\x0a}';class XR extends a{constructor(Xc=0.4,XG=0.6,W0=!0x1){super(['image','bg','mask'],{'rect':'4f','flipX':'1i'},Xf(Xc,XG)),this['mirror']=W0;}async['load'](Xc){var XG;const W0=Xc instanceof r&&Xc['shaderCtx'];this['loaded']||!W0||(this['bgTexture']=new Z(W0,this['size']),await super['load'](Xc),(XG=this['shader'])==null||XG['setUniform']('flipX',[this['mirror']?0x1:0x0]));}['unload'](){var Xc;this['loaded']&&((Xc=this['bgTexture'])==null||Xc['dispose'](),delete this['bgTexture'],super['unload']());}async['process'](Xc,XG){const W0=q9(Xc);if(!W0)return!0x1;const {shader:W1,bgTexture:W2}=this;if(!W1||!W2)return!0x1;const W3=q6(W0['box']);return W1['process']([XG,W2['texture'](),W0['texture']],{'rect':W3}),!0x0;}['background'](){return this['bgTexture'];}['setMirror'](Xc){var XG;this['mirror']=Xc,(XG=this['shader'])==null||XG['setUniform']('flipX',[Xc?0x1:0x0]);}['setupVideo'](Xc){var XG;super['setupVideo'](Xc),(XG=this['bgTexture'])==null||XG['resize'](this['size']);}}const Xf=(Xc=0.4,XG=0.6)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20vec4\x20rect;\x0auniform\x20int\x20flipX;\x0auniform\x20sampler2D\x20image;\x0auniform\x20sampler2D\x20bg;\x0auniform\x20sampler2D\x20mask;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20xyMask\x20=\x20(xy\x20-\x20rect.xy)\x20/\x20rect.zw;\x0a\x20\x20\x20\x20vec2\x20xyBg\x20=\x20vec2(bool(flipX)\x20?\x201.0\x20-\x20xy.x\x20:\x20xy.x,\x20xy.y);\x0a\x20\x20\x20\x20float\x20prob\x20=\x20texture2D(mask,\x20xyMask).r;\x0a\x20\x20\x20\x20bool\x20flag\x20=\x20prob\x20<\x20'+Xc['toFixed'](0x3)+'\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min(xyMask.x,\x20xyMask.y)\x20<\x200.0\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max(xyMask.x,\x20xyMask.y)\x20>\x201.0;\x0a\x20\x20\x20\x20if\x20(flag)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20texture2D(bg,\x20xyBg);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20float\x20alpha\x20=\x20min(1.0,\x20(prob\x20-\x20'+Xc['toFixed'](0x5)+')\x20/\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(XG-Xc)['toFixed'](0x3)+');\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20mix(texture2D(bg,\x20xyBg),\x20texture2D(image,\x20xy),\x20alpha);\x0a}';class XU extends a{constructor(Xc=0.5,XG=!0x1){super(['image','bg'],{'alpha':'1f','flipX':'1i'},Xa),this['alpha']=Xc,this['mirror']=XG;}async['load'](Xc){var XG;const W0=Xc instanceof r&&Xc['shaderCtx'];this['loaded']||!W0||(this['bgTexture']=new Z(W0,this['size']),await super['load'](Xc),(XG=this['shader'])==null||XG['setUniform']('flipX',[this['mirror']?0x1:0x0]));}['unload'](){var Xc;this['loaded']&&((Xc=this['bgTexture'])==null||Xc['dispose'](),delete this['bgTexture'],super['unload']());}async['process'](Xc,XG){const {shader:W0,bgTexture:W1}=this;return!W0||!W1?!0x1:(W0['process']([XG,W1['texture']()],{'alpha':[this['alpha']]}),!0x0);}['background'](){return this['bgTexture'];}['setAlpha'](Xc){this['alpha']=Xc;}['setMirror'](Xc){var XG;this['mirror']=Xc,(XG=this['shader'])==null||XG['setUniform']('flipX',[Xc?0x1:0x0]);}['setupVideo'](Xc){var XG;super['setupVideo'](Xc),(XG=this['bgTexture'])==null||XG['resize'](this['size']);}}const Xa='\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20float\x20alpha;\x0auniform\x20int\x20flipX;\x0auniform\x20sampler2D\x20image;\x0auniform\x20sampler2D\x20bg;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20xyBg\x20=\x20vec2(bool(flipX)\x20?\x201.0\x20-\x20xy.x\x20:\x20xy.x,\x20xy.y);\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20mix(texture2D(image,\x20xy),\x20texture2D(bg,\x20xyBg),\x20alpha);\x0a}';class XD extends a{constructor(Xc=0x7,XG=0.05,W0=Math['floor'](0x2*Xc)){super(['image'],{'kernel':'1fv'},XE('y',W0,XG)),this['smooth']=Xc,this['sense']=XG,this['radius']=W0,this['gaussian']=[];const W1=-0.5/Xc**0x2;this['gaussian']['push'](0x1);let W2=0x1;for(let W3=0x1;W3<=W0;W3++){const W4=Math['exp'](W1*W3**0x2);this['gaussian']['push'](W4),this['gaussian']['unshift'](W4),W2+=0x2*W4;}for(let W5=0x0;W5<0x2*W0+0x1;W5++)this['gaussian'][W5]/=W2;}async['load'](Xc){var XG;const W0=Xc instanceof r&&Xc['shaderCtx'];this['loaded']||!W0||(this['xpass']=new e(W0,this['size'],['image'],{'kernel':'1fv'},XE('x',this['radius'],this['sense'])),await super['load'](Xc),this['xpass']['setUniform']('kernel',this['gaussian']),(XG=this['shader'])==null||XG['setUniform']('kernel',this['gaussian']));}['unload'](){var Xc;this['loaded']&&((Xc=this['xpass'])==null||Xc['dispose'](),delete this['xpass'],super['unload']());}async['process'](Xc,XG){const {xpass:W0,shader:W1}=this;return!W0||!W1?!0x1:(W0['process']([XG]),W1['process']([W0['output']()]),!0x0);}['setupVideo'](Xc){var XG;super['setupVideo'](Xc),(XG=this['xpass'])==null||XG['resize'](Xc);}}function XE(Xc,XG,W0){const W1=Xc==='x'?['x','x','0']:['y','0','y'];return'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20sampler2D\x20image;\x0auniform\x20vec2\x20wh;\x0auniform\x20float\x20kernel['+(0x2*XG+0x1)+'];\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20center\x20=\x20texture2D(image,\x20xy).rgb;\x0a\x20\x20\x20\x20vec3\x20result\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20float\x20norm\x20=\x200.0;\x0a\x20\x20\x20\x20for\x20(int\x20'+W1[0x0]+'\x20=\x20'+-XG+';\x20'+W1[0x0]+'\x20<=\x20'+XG+';\x20'+W1[0x0]+'++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20pixel\x20=\x20texture2D(image,\x20xy\x20+\x20vec2('+W1[0x1]+',\x20'+W1[0x2]+')\x20/\x20wh).rgb;\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20diff\x20=\x20center\x20-\x20pixel;\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20kc\x20=\x20'+0x1/(W0*Math['sqrt'](0x2*Math['PI']))+'\x20*\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20exp(-0.5\x20*\x20dot(diff,\x20diff)\x20/\x20'+W0*W0+');\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20k\x20=\x20kernel['+W1[0x0]+'\x20+\x20'+XG+']\x20*\x20kc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20result\x20+=\x20k\x20*\x20pixel;\x0a\x20\x20\x20\x20\x20\x20\x20\x20norm\x20+=\x20k;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(result\x20/\x20norm,\x201.0);\x0a}';}var XL=Object['defineProperty'],Xw=Object['getOwnPropertySymbols'],XS=Object['prototype']['hasOwnProperty'],Xo=Object['prototype']['propertyIsEnumerable'],Xn=(Xc,XG,W0)=>XG in Xc?XL(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,XO=(Xc,XG)=>{for(var W0 in XG||(XG={}))XS['call'](XG,W0)&&Xn(Xc,W0,XG[W0]);if(Xw){for(var W0 of Xw(XG))Xo['call'](XG,W0)&&Xn(Xc,W0,XG[W0]);}return Xc;};class Xl extends a{constructor(Xc=0.55,XG=0x200,W0={'width':0x100,'height':0x100}){super(['image','mask','maskDist'],{'rect':'4f'},Xu(Xc)),this['thresh']=Xc,this['radius']=XG,this['maskSize']=W0,this['ordinal']=i['PostRender'];}async['load'](Xc){const XG=Xc instanceof r&&Xc['shaderCtx'];if(!(this['loaded']||!XG))return this['distShader']=new e(XG,this['maskSize'],['image'],{},XH(this['thresh'],this['radius']),void 0x0,!0x1,!0x1),super['load'](Xc);}['unload'](){var Xc;this['loaded']&&((Xc=this['distShader'])==null||Xc['dispose'](),delete this['distShader'],super['unload']());}async['process'](Xc,XG){const W0=q9(Xc),{shader:W1,distShader:W2}=this;if(!W0||!W1||!W2)return!0x1;const W3=q6(W0['box']);return this['maskSize']=XO({},W0['size']),W2['resize'](W0['size']),W2['process']([W0['texture']]),W1['process']([XG,W0['texture'],W2['output']()],{'rect':W3}),!0x0;}}const Xu=(Xc=0.55,XG=0.02)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20vec4\x20rect;\x0auniform\x20sampler2D\x20image;\x0auniform\x20sampler2D\x20mask;\x0auniform\x20sampler2D\x20maskDist;\x0a\x0afloat\x20readMask(vec2\x20dxy)\x20{\x0a\x20\x20\x20\x20return\x20texture2D(mask,\x20(xy\x20+\x20dxy\x20-\x20rect.xy)\x20/\x20rect.zw).r;\x0a}\x0a\x0avec4\x20readProp(vec2\x20dxyX1,\x20vec2\x20dxyX2)\x20{\x0a\x20\x20\x20\x20vec2\x20dxy\x20=\x20abs(dxyX1.x)\x20+\x20abs(dxyX1.y)\x20<\x20'+XG['toFixed'](0x4)+'\x20&&\x0a\x20\x20\x20\x20\x20\x20\x20\x20readMask(dxyX2)\x20<\x20'+Xc+'\x20?\x20dxyX2\x20:\x20dxyX1;\x0a\x20\x20\x20\x20return\x20texture2D(image,\x20xy\x20+\x20dxy);\x0a}\x0a\x0afloat\x20refineMask(vec2\x20dxyI,\x20float\x20s,\x20float\x20d)\x20{\x0a\x20\x20\x20\x20for\x20(int\x20i\x20=\x20-4;\x20i\x20<=\x204;\x20i++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20di\x20=\x20max(d\x20+\x20float(i)\x20*\x20s,\x200.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20(readMask(dxyI\x20*\x20di)\x20<\x20'+Xc+')\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20d\x20=\x20di;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20break;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20return\x20d;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20xyMask\x20=\x20(xy\x20-\x20rect.xy)\x20/\x20rect.zw;\x0a\x20\x20\x20\x20vec4\x20dist\x20=\x20texture2D(maskDist,\x20xyMask)\x20*\x20rect.zwzw;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(image,\x20xy);\x0a\x20\x20\x20\x20bool\x20bg\x20=\x20texture2D(mask,\x20xyMask).r\x20<\x20'+Xc+'\x20||\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20all(lessThanEqual(dist,\x20vec4(0.0)));\x0a\x20\x20\x20\x20if\x20(bg)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20color;\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20vec2\x20whPix\x20=\x201.0\x20/\x20wh;\x0a\x20\x20\x20\x20dist\x20=\x20vec4(refineMask(vec2(-1.0,\x20\x200.0),\x20whPix.x,\x20dist.x),\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20refineMask(vec2(\x200.0,\x20-1.0),\x20whPix.y,\x20dist.y),\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20refineMask(vec2(\x201.0,\x20\x200.0),\x20whPix.x,\x20dist.z),\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20refineMask(vec2(\x200.0,\x20\x201.0),\x20whPix.y,\x20dist.w));\x0a\x0a\x20\x20\x20\x20float\x20x0\x20=\x20dist.x;\x0a\x20\x20\x20\x20bg\x20=\x20x0\x20>\x200.0;\x0a\x20\x20\x20\x20vec4\x20cx0\x20=\x20bg\x20?\x20readProp(vec2(-x0,\x200.0),\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2(-2.0\x20*\x20x0\x20+\x20whPix.x,\x200.0))\x20:\x20color;\x0a\x20\x20\x20\x20x0\x20=\x20bg\x20?\x201.0\x20/\x20x0\x20:\x200.0;\x0a\x0a\x20\x20\x20\x20float\x20y0\x20=\x20dist.y;\x0a\x20\x20\x20\x20bg\x20=\x20y0\x20>\x200.0;\x0a\x20\x20\x20\x20vec4\x20cy0\x20=\x20bg\x20?\x20readProp(vec2(0.0,\x20-y0),\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2(0.0,\x20-2.0\x20*\x20y0\x20+\x20whPix.y))\x20:\x20color;\x0a\x20\x20\x20\x20y0\x20=\x20bg\x20?\x201.0\x20/\x20y0\x20:\x200.0;\x0a\x0a\x20\x20\x20\x20float\x20x1\x20=\x20dist.z;\x0a\x20\x20\x20\x20bg\x20=\x20x1\x20>\x200.0;\x0a\x20\x20\x20\x20vec4\x20cx1\x20=\x20bg\x20?\x20readProp(vec2(x1,\x200.0),\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2(2.0\x20*\x20x1\x20-\x20whPix.x,\x200.0))\x20:\x20color;\x0a\x20\x20\x20\x20x1\x20=\x20bg\x20?\x201.0\x20/\x20x1\x20:\x200.0;\x0a\x0a\x20\x20\x20\x20float\x20y1\x20=\x20dist.w;\x0a\x20\x20\x20\x20bg\x20=\x20y1\x20>\x200.0;\x0a\x20\x20\x20\x20vec4\x20cy1\x20=\x20bg\x20?\x20readProp(vec2(0.0,\x20y1),\x0a\x20\x20\x20\x20\x20\x20\x20\x20vec2(0.0,\x202.0\x20*\x20y1\x20-\x20whPix.y))\x20:\x20color;\x0a\x20\x20\x20\x20y1\x20=\x20bg\x20?\x201.0\x20/\x20y1\x20:\x200.0;\x0a\x0a\x20\x20\x20\x20float\x20s\x20=\x201.0\x20/\x20(x0\x20+\x20x1\x20+\x20y0\x20+\x20y1);\x0a\x20\x20\x20\x20color\x20=\x20cx0\x20*\x20x0\x20*\x20s\x20+\x20cx1\x20*\x20x1\x20*\x20s\x20+\x20cy0\x20*\x20y0\x20*\x20s\x20+\x20cy1\x20*\x20y1\x20*\x20s;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20color;\x0a}',XH=(Xc=0.55,XG=0x200,W0=0x8)=>'\x0aprecision\x20mediump\x20float;\x0avarying\x20vec2\x20xy;\x0auniform\x20vec2\x20wh;\x0auniform\x20sampler2D\x20image;\x0a\x0abool\x20background(vec2\x20dxy)\x20{\x0a\x20\x20\x20\x20return\x20texture2D(image,\x20xy\x20+\x20dxy).r\x20<\x20'+Xc+';\x0a}\x0a\x0afloat\x20traverse(vec2\x20dxy)\x20{\x0a\x20\x20\x20\x20bool\x20bg\x20=\x20false;\x0a\x20\x20\x20\x20float\x20d\x20=\x201.0;\x0a\x20\x20\x20\x20for\x20(int\x20di\x20=\x201;\x20di\x20<\x20'+Math['ceil'](XG/W0)+';\x20di++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20d\x20=\x20bg\x20?\x20d\x20:\x20float(di\x20*\x20'+W0+');\x0a\x20\x20\x20\x20\x20\x20\x20\x20bg\x20=\x20bg\x20||\x20background(d\x20*\x20dxy);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20bool\x20bg1\x20=\x20bg;\x0a\x20\x20\x20\x20for\x20(int\x20di\x20=\x201;\x20di\x20<\x20'+W0+';\x20di++)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20float\x20d1\x20=\x20d\x20-\x201.0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bg1\x20=\x20bg1\x20&&\x20background(d1\x20*\x20dxy);\x0a\x20\x20\x20\x20\x20\x20\x20\x20d\x20=\x20bg1\x20?\x20d1\x20:\x20d;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20return\x20bg\x20?\x20d\x20:\x200.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20if\x20(background(vec2(0.0)))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20return;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20vec2\x20whPix\x20=\x201.0\x20/\x20wh;\x0a\x20\x20\x20\x20gl_FragColor\x20=\x20vec4(\x0a\x20\x20\x20\x20\x20\x20\x20\x20traverse(vec2(-whPix.x,\x200.0)),\x0a\x20\x20\x20\x20\x20\x20\x20\x20traverse(vec2(0.0,\x20-whPix.y)),\x0a\x20\x20\x20\x20\x20\x20\x20\x20traverse(vec2(whPix.x,\x200.0)),\x0a\x20\x20\x20\x20\x20\x20\x20\x20traverse(vec2(0.0,\x20whPix.y)))\x20/\x20wh.xyxy;\x0a}';var XK=Object['defineProperty'],Xp=Object['getOwnPropertySymbols'],XY=Object['prototype']['hasOwnProperty'],XB=Object['prototype']['propertyIsEnumerable'],Xs=(Xc,XG,W0)=>XG in Xc?XK(Xc,XG,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':W0}):Xc[XG]=W0,XP=(Xc,XG)=>{for(var W0 in XG||(XG={}))XY['call'](XG,W0)&&Xs(Xc,W0,XG[W0]);if(Xp){for(var W0 of Xp(XG))XB['call'](XG,W0)&&Xs(Xc,W0,XG[W0]);}return Xc;};class Xg extends t{constructor(Xc,XG=0.5,W0=0.1,W1={'minCutOff':0.05,'minCutOffD':0.05,'beta':0x5}){super(),this['callback']=Xc,this['rangeMax']=XG,this['rangeMin']=W0,this['filterParams']=W1,this['size']={'width':0x0,'height':0x0},this['ordinal']=i['PreRender'],this['rangeRatio']=(0x1-W0)/(XG-W0);}async['load'](Xc){if(this['loaded']||!(Xc instanceof r)||!Xc['shaderCtx'])return;const {shaderCtx:XG}=Xc;return this['image']=new Z(XG,this['size'],!0x1,!0x0,!0x0),this['reader']=new o(XG),this['setupVideo'](this['size']),super['load'](Xc);}['unload'](){var Xc,XG;this['loaded']&&((Xc=this['image'])==null||Xc['dispose'](),delete this['image'],(XG=this['reader'])==null||XG['dispose'](),delete this['reader'],super['unload']());}async['update'](Xc,XG){var W0;const {image:W1,reader:W2}=this;if(!this['loaded']||!W1||!W2)return;const W3=W6=>Promise['race']([W6,!0x1]),W4=this['pending']&&await W3(this['pending']);if(W4===!0x1||(W1['update'](XG),this['pending']=W2['readAsync'](W1,W1['levelCount']()-0x1),!W4))return;let W5=(0.299*W4[0x0]+0.587*W4[0x1]+0.114*W4[0x2])/0xff;W5=this['filter'](W5),W5=Math['min'](Math['max'](W5,this['rangeMin']),this['rangeMax']),W5=(W5-this['rangeMin'])*this['rangeRatio']+this['rangeMin'],(W0=this['callback'])==null||W0['call'](this,W5);}['setupVideo'](Xc){var XG;return this['size']=XP({},Xc),(XG=this['image'])==null||XG['resize'](Xc),!0x0;}['setCallback'](Xc){this['callback']=Xc;}['filter'](Xc){if(!this['smooth'])return this['smooth']={'val':Xc,'der':0x0,'time':Date['now']()/0x3e8},Xc;const {smooth:XG,filterParams:W0}=this,W1=Date['now']()/0x3e8;if(W1<=XG['time'])return Xc;const W2=0x1/(W1-XG['time']);XG['time']=W1;const W3=(Xc-XG['val'])*W2,W4=W7=>0x1/(0x1+W2/(0x2*Math['PI']*W7)),W5=W4(W0['minCutOffD']);XG['der']=XG['der']+W5*(W3-XG['der']);const W6=W4(W0['minCutOff']+W0['beta']*Math['abs'](XG['der']));return XG['val']=XG['val']+W6*(Xc-XG['val']),XG['val'];}}class XN extends t{constructor(Xc){super(),this['callback']=Xc,this['ordinal']=i['PostProcess'];}async['update'](Xc,XG){if(this['loaded'])return this['callback'](Xc),super['update'](Xc,XG);}}class XI extends XN{}class XC extends XN{}class Xb extends t{constructor(Xc){super(),this['predicate']=Xc,this['ordinal']=i['PreProcess'];}async['update'](Xc,XG){this['loaded']&&(Xc['poses']=Xc['poses']['filter'](this['predicate']));}}class XV extends t{constructor(Xc){super(),this['predicate']=Xc,this['ordinal']=i['PreProcess'];}async['update'](Xc,XG){if(this['loaded'])return Xc['faces']=Xc['faces']['filter'](this['predicate']),super['update'](Xc,XG);}}function XM(Xc,XG=0x0){const W0=Xc;W0['results']=[],W0['delay']=XG;const W1=W0['update'];return W0['update']=async function(W2,W3){for(this['results']['push'](W2);this['results']['length']>this['delay'];)this['results']['shift']();return W1['call'](this,this['results'][0x0]||W2,W3);},W0;}class Xh extends t{constructor(Xc){super(),this['callback']=Xc,this['fpsStart']=Date['now'](),this['fpsCount']=0x0,this['ordinal']=i['PostRender'];}async['load'](Xc){return this['fpsStart']=Date['now'](),this['fpsCount']=0x0,super['load'](Xc);}async['update'](Xc,XG){if(this['loaded']){if(this['fpsCount']++,this['fpsCount']>=0x1e){const W0=Date['now'](),W1=this['fpsCount']*0x3e8/(W0-this['fpsStart']);this['fpsCount']=0x0,this['fpsStart']=W0,this['callback'](W1);}return super['update'](Xc,XG);}}}export{XZ as BgBlurPlugin,XR as BgReplacePlugin,XD as BilateralPlugin,Xl as BodyPatchPlugin,Xg as BrightnessPlugin,XN as CallbackPlugin,XM as DelayPlugin,n as DilationShader,s as ErosionShader,XC as FaceCallbackPlugin,XV as FaceFilterPlugin,XQ as MaskBinaryPlugin,qM as MaskDilationPlugin,X3 as MaskErosionPlugin,qn as MaskFilterPlugin,Xq as MaskMorphPlugin,qB as MaskSharpPlugin,qU as MaskSmoothPlugin,Xr as MaskStepPlugin,q5 as MaskUploadPlugin,qr as MaskUpscalePlugin,Xh as PerfDevPlugin,XI as PoseCallbackPlugin,Xb as PoseFilterPlugin,XU as VideoMergePlugin,q8 as getMaskBuf,q7 as getMaskObj,q9 as getMaskTex,q6 as maskRectUniform};
