import{FaceTracker as y,PoseTracker as v,HandTracker as X,MaskTracker as n,HairTracker as W}from'@geenee/bodytracking';import{Processor as D,Engine as P,VideoCapture as G}from'@geenee/armature';class s extends D{constructor(){super(...arguments),this['faceTracker']=new y(),this['cameraAngleBase']=0xa/0xb4*Math['PI'];}async['init'](F,j,K){return await this['faceTracker']['init'](F['token'],F['root'],F['cache'],F['highP'],F['mask'],F['maskExt'],F['maskSize']),await this['faceTracker']['prepare'](),super['init'](F,j,K);}['reset'](){this['faceTracker']['reset'](),super['reset']();}['dispose'](){this['faceTracker']['dispose']();}async['process'](F,j){return{'faces':(await this['faceTracker']['process'](F,j))['map'](K=>{const {keypoints:J,mask:y0,score:y1}=K,y2=K&&this['params']['transform']?this['faceTracker']['align'](K['keypoints']):void 0x0,y3=y2&&this['params']['metric']?this['faceTracker']['metricPoints']():void 0x0,y4=y2&&this['params']['backproj']?this['faceTracker']['backprojPoints']():void 0x0;return{'pixel':J,'metric':y3,'backproj':y4,'transform':y2,'mask':y0,'score':y1};})};}['setupVideo'](F,j){super['setupVideo'](F,j),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['faceTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['faceTracker']['reset']();}}class Z extends P{constructor(F,j=G){super(s,F,j);}}class o extends D{constructor(){super(),this['poseTracker']=new v(),this['cameraAngleBase']=0xf/0xb4*Math['PI'];const F=/iPhone|iPad|iPod/i['test'](navigator['userAgent']);this['optimalSize']=F?0x200:0x400;}async['init'](F,j,K){return await this['poseTracker']['init'](F['token'],F['root'],F['cache'],F['mask']),await this['poseTracker']['prepare'](),super['init'](F,j,K);}['reset'](){return this['poseTracker']['reset'](),super['reset']();}['dispose'](){this['poseTracker']['dispose']();}async['process'](F,j){return{'poses':(await this['poseTracker']['process'](F,j))['map'](K=>({'points':S(J=>K['keypoints'][N[J]]),'score':K['score'],'mask':K['mask'],'timestamp':j,'debug':K['debug']}))};}['setupVideo'](F,j){super['setupVideo'](F,j),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['poseTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['poseTracker']['reset']();}}class z extends P{constructor(F,j=G){super(o,F,j);}}const r=['nose','eyeInnerL','eyeL','eyeOutterL','eyeInnerR','eyeR','eyeOutterR','earL','earR','mouthL','mouthR','shoulderL','shoulderR','elbowL','elbowR','wristL','wristR','pinkyL','pinkyR','indexL','indexR','thumbL','thumbR','hipL','hipR','kneeL','kneeR','ankleL','ankleR','heelL','heelR','footIndexL','footIndexR'];function q(F,j){return Object['fromEntries'](j['map'](K=>[K,F(K)]));}const C=(F,j)=>q(F,j),S=F=>q(F,r),N=S(F=>r['indexOf'](F));class R extends D{constructor(){super(...arguments),this['handTracker']=new X(),this['cameraAngleBase']=0xa/0xb4*Math['PI'];}async['init'](F,j,K){return await this['handTracker']['init'](F['token'],F['root'],F['cache'],F['wrist']),await this['handTracker']['prepare'](),super['init'](F,j,K);}['reset'](){this['handTracker']['reset'](),super['reset']();}['dispose'](){this['handTracker']['dispose']();}async['process'](F,j){return{'hands':(await this['handTracker']['process'](F,j))['map'](K=>({'points':K['keypoints'],'score':K['score'],'handedness':K['handedness'],'phalanxes':K['phalanxes'],'wrist':K['wrist'],'debug':K['debug']}))};}['setupVideo'](F,j){super['setupVideo'](F,j),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['handTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['handTracker']['reset']();}}class Y extends P{constructor(F,j=G){super(R,F,j);}}class O extends D{constructor(){super(...arguments),this['maskTracker']=new n();}async['init'](F,j,K){return await this['maskTracker']['init'](F['token'],F['root'],F['cache'],F['smooth'],F['masksm']),await this['maskTracker']['prepare'](),super['init'](F,j,K);}['reset'](){this['maskTracker']['reset'](),super['reset']();}['dispose'](){this['maskTracker']['dispose']();}async['process'](F,j){return{'masks':(await this['maskTracker']['process'](F,j))['map'](K=>({'mask':K}))};}}class U extends P{constructor(F,j=G){super(O,F,j);}}class Q extends D{constructor(){super(...arguments),this['hairTracker']=new W();}async['init'](F,j,K){return await this['hairTracker']['init'](F['token'],F['root'],F['cache'],F['smooth']),await this['hairTracker']['prepare'](),super['init'](F,j,K);}['reset'](){this['hairTracker']['reset'](),super['reset']();}['dispose'](){this['hairTracker']['dispose']();}async['process'](F,j){return{'masks':(await this['hairTracker']['process'](F,j))['map'](K=>({'mask':K}))};}}class w extends P{constructor(F,j=G){super(Q,F,j);}}export{Z as FaceEngine,s as FaceProcessor,w as HairEngine,Q as HairProcessor,Y as HandEngine,R as HandProcessor,U as MaskEngine,O as MaskProcessor,z as PoseEngine,N as PosePointIdx,r as PosePointNames,o as PoseProcessor,q as mapKeys,C as mapPoints,S as mapPose};
